# Rucio - Scientific Data Management

## (Daemon Container)

Rucio is a software framework that provides functionality to organize, manage, and access large volumes of scientific data using customisable policies. The data can be spread across globally distributed locations and across heterogeneous data centers, uniting different storage and network technologies as a single federated entity. Rucio offers advanced features such as distributed data recovery or adaptive replication, and is highly scalable, modular, and extensible. Rucio has been originally developed to meet the requirements of the high-energy physics experiment ATLAS, and is continuously extended to support LHC experiments and other diverse scientific communities.

## Documentation

General information and latest documentation about Rucio can be found at [readthedocs](https://rucio.readthedocs.io) or on our [webpage](https://rucio.cern.ch).

## Developers

For information on how to contribute to Rucio, please refer and follow our [CONTRIBUTING](<https://github.com/rucio/rucio/blob/master/CONTRIBUTING.rst>) guidelines.

## Getting Started

This image provides the Rucio daemons. Each daemon has to be run in a separate container. It supports MySQL, PostgreSQL, Oracle and SQLite as database backends.

This image expects that there is an already initialised Rucio DB. To start a simple `judge-cleaner` daemon using a database on `mysql.db` without an additional parameters just run this:

    docker run \
      --name=rucio-judge-cleaner \
      -e RUCIO_CFG_DATABASE_DEFAULT="mysql://rucio:rucio@mysql.db/rucio" \
      -e RUCIO_DAEMON=judge-cleaner \
      rucio/rucio-daemons

The `RUCIO_DAEMON` environment variable gives the name of the rucio daemon.

Rucio can be configured fully using environment variables like `RUCIO_CFG_DATABASE_DEFAULT`. If you want to instead use a complete rucio.cfg it can also be mounted. This will then ignore the `RUCIO_CFG` environment variables:

The rucio.cfg is used to configure the database backend and the daemons:

    docker run \
      --name=rucio-judge-cleaner \
      -v /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg \
      -e RUCIO_DAEMON=judge-cleaner \
      rucio/rucio-daemons

By default the daemon logs are written to stdout and stderr if you want to write to a file you can use `RUCIO_ENABLE_LOGS` like this:

    docker run \
      --name=rucio-judge-cleaner \
      -v /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg \
      -v /tmp/logs:/var/log/rucio \
      -e RUCIO_DAEMON=judge-cleaner \
      -e RUCIO_ENABLE_LOGS=True \
      rucio/rucio-daemons

## Environment Variables

As shown in the examples above the rucio-daemon image can be configured using environment variables that are passed with `docker run`. Below is a list of all available variables and their behaviour:

### `RUCIO_DAEMON`

This variable is mandatory and it specifies the name of the daemon, e.g., `hermes`, `kronos`, `judge-evaluator`, etc.

### `RUCIO_DAEMON_ARGS`

Any additional command line parameter can be specified here, e.g., `--run-once`. This field is optional.

### `RUCIO_ENABLE_LOGS`

By default the log output of the daemon is written to stdout and stderr. If you set this variable to `True` the output will be written to `access_log` and `error_log` under `/var/log/rucio`.

### `RUCIO_PRINT_CFG`

This variable can be used to print the content of autogenerated rucio.cfg to the logs. It will be printed once at the daemon startup.

## `RUCIO_CFG` configuration parameters:

Environment variables can be used to set values for the auto-generated rucio.cfg. The names are derived from the actual names in the configuration file prefixed by `RUCIO_CFG`, e.g., the `default` value in the `database` section becomes `RUCIO_CFG_DATABASE_DEFAULT`.
The available environment variables are:

* `RUCIO_CFG_ACCOUNTS_SPECIAL_ACCOUNTS`
* `RUCIO_CFG_AUDITOR_CACHE`
* `RUCIO_CFG_AUDITOR_RESULTS`
* `RUCIO_CFG_AUTOMATIX_DATASET_LIFETIME`
* `RUCIO_CFG_AUTOMATIX_SET_METADATA`
* `RUCIO_CFG_AUTOMATIX_SITES`
* `RUCIO_CFG_AUTOMATIX_SLEEP_TIME`
* `RUCIO_CFG_CLIENT_ACCOUNT`
* `RUCIO_CFG_CLIENT_AUTH_HOST`
* `RUCIO_CFG_CLIENT_AUTH_TYPE`
* `RUCIO_CFG_CLIENT_CA_CERT`
* `RUCIO_CFG_CLIENT_CLIENT_CERT`
* `RUCIO_CFG_CLIENT_CLIENT_KEY`
* `RUCIO_CFG_CLIENT_CLIENT_VO`
* `RUCIO_CFG_CLIENT_CLIENT_X509_PROXY`
* `RUCIO_CFG_CLIENT_PASSWORD`
* `RUCIO_CFG_CLIENT_REQUEST_RETRIES`
* `RUCIO_CFG_CLIENT_RUCIO_HOST`
* `RUCIO_CFG_CLIENT_USERNAME`
* `RUCIO_CFG_COMMON_LOGDIR`
* `RUCIO_CFG_COMMON_LOGLEVEL`
* `RUCIO_CFG_COMMON_MAILTEMPLATEDIR`
* `RUCIO_CFG_COMMON_MULTI_VO`
* `RUCIO_CFG_CONVEYOR_ALLOW_USER_OIDC_TOKENS`
* `RUCIO_CFG_CONVEYOR_BRING_ONLINE`
* `RUCIO_CFG_CONVEYOR_CACERT`
* `RUCIO_CFG_CONVEYOR_CACHE_TIME`
* `RUCIO_CFG_CONVEYOR_FTSHOSTS`
* `RUCIO_CFG_CONVEYOR_FTSMONHOSTS`
* `RUCIO_CFG_CONVEYOR_POLL_TIMEOUT`
* `RUCIO_CFG_CONVEYOR_QUEUE_MODE`
* `RUCIO_CFG_CONVEYOR_REQUEST_OIDC_AUDIENCE`
* `RUCIO_CFG_CONVEYOR_REQUEST_OIDC_SCOPE`
* `RUCIO_CFG_CONVEYOR_SCHEME`
* `RUCIO_CFG_CONVEYOR_SUBMIT_TIMEOUT`
* `RUCIO_CFG_CONVEYOR_TRANSFERTOOL`
* `RUCIO_CFG_CONVEYOR_USE_DETERMINISTIC_ID`
* `RUCIO_CFG_CONVEYOR_USER_ACTIVITIES`
* `RUCIO_CFG_CONVEYOR_USERCERT`
* `RUCIO_CFG_CONVEYOR_USER_TRANSFERS`
* `RUCIO_CFG_CONVEYOR_USING_MEMCACHE`
* `RUCIO_CFG_CREDENTIALS_GCS`
* `RUCIO_CFG_CREDENTIALS_SIGNATURE_LIFETIME`
* `RUCIO_CFG_DATABASE_DEFAULT`
* `RUCIO_CFG_DATABASE_ECHO`
* `RUCIO_CFG_DATABASE_MAX_OVERFLOW`
* `RUCIO_CFG_DATABASE_POOL_RECYCLE`
* `RUCIO_CFG_DATABASE_POOL_RESET_ON_RETURN`
* `RUCIO_CFG_DATABASE_POOL_SIZE`
* `RUCIO_CFG_DATABASE_POOL_TIMEOUT`
* `RUCIO_CFG_DATABASE_POWUSERACCOUNT`
* `RUCIO_CFG_DATABASE_POWUSERPASSWORD`
* `RUCIO_CFG_DATABASE_SCHEMA`
* `RUCIO_CFG_MESSAGING_CACHE_ACCOUNT`
* `RUCIO_CFG_MESSAGING_CACHE_BROKERS`
* `RUCIO_CFG_MESSAGING_CACHE_DESTINATION`
* `RUCIO_CFG_MESSAGING_CACHE_PORT`
* `RUCIO_CFG_MESSAGING_CACHE_SSL_CERT_FILE`
* `RUCIO_CFG_MESSAGING_CACHE_SSL_KEY_FILE`
* `RUCIO_CFG_MESSAGING_CACHE_VONAME`
* `RUCIO_CFG_MESSAGING_FTS3_BROKERS`
* `RUCIO_CFG_MESSAGING_FTS3_DESTINATION`
* `RUCIO_CFG_MESSAGING_FTS3_NONSSL_PORT`
* `RUCIO_CFG_MESSAGING_FTS3_PASSWORD`
* `RUCIO_CFG_MESSAGING_FTS3_PORT`
* `RUCIO_CFG_MESSAGING_FTS3_SSL_CERT_FILE`
* `RUCIO_CFG_MESSAGING_FTS3_SSL_KEY_FILE`
* `RUCIO_CFG_MESSAGING_FTS3_USERNAME`
* `RUCIO_CFG_MESSAGING_FTS3_USE_SSL`
* `RUCIO_CFG_MESSAGING_FTS3_VONAME`
* `RUCIO_CFG_MESSAGING_HERMES_BROKERS`
* `RUCIO_CFG_MESSAGING_HERMES_BROKER_VIRTUAL_HOST`
* `RUCIO_CFG_MESSAGING_HERMES_DESTINATION`
* `RUCIO_CFG_MESSAGING_HERMES_EMAIL_FROM`
* `RUCIO_CFG_MESSAGING_HERMES_EMAIL_TEST`
* `RUCIO_CFG_MESSAGING_HERMES_NONSSL_PORT`
* `RUCIO_CFG_MESSAGING_HERMES_PASSWORD`
* `RUCIO_CFG_MESSAGING_HERMES_PORT`
* `RUCIO_CFG_MESSAGING_HERMES_SSL_CERT_FILE`
* `RUCIO_CFG_MESSAGING_HERMES_SSL_KEY_FILE`
* `RUCIO_CFG_MESSAGING_HERMES_USERNAME`
* `RUCIO_CFG_MESSAGING_HERMES_USE_SSL`
* `RUCIO_CFG_MESSAGING_HERMES_VONAME`
* `RUCIO_CFG_MONITOR_CARBON_PORT`
* `RUCIO_CFG_MONITOR_CARBON_SERVER`
* `RUCIO_CFG_MONITOR_ENABLE_METRICS`
* `RUCIO_CFG_MONITOR_USER_SCOPE`
* `RUCIO_CFG_NAGIOS_FTS_VO`
* `RUCIO_CFG_NAGIOS_PROXY`
* `RUCIO_CFG_NAGIOS_UPDATE_DISTANCES`
* `RUCIO_CFG_OIDC_ADMIN_ISSUER`
* `RUCIO_CFG_OIDC_EXPECTED_AUDIENCE`
* `RUCIO_CFG_OIDC_IDPSECRETS`
* `RUCIO_CFG_POLICY_LFN2PFN_ALGORITHM_DEFAULT`
* `RUCIO_CFG_POLICY_LFN2PFN_MODULE`
* `RUCIO_CFG_POLICY_PACKAGE`
* `RUCIO_CFG_POLICY_PERMISSION`
* `RUCIO_CFG_POLICY_SCHEMA`
* `RUCIO_CFG_POLICY_SUPPORT`
* `RUCIO_CFG_POLICY_SUPPORT_RUCIO`
* `RUCIO_CFG_TRACER_KRONOS_BROKERS`
* `RUCIO_CFG_TRACER_KRONOS_CHUNKSIZE`
* `RUCIO_CFG_TRACER_KRONOS_DATASET_WAIT`
* `RUCIO_CFG_TRACER_KRONOS_EXCLUDED_USRDNS`
* `RUCIO_CFG_TRACER_KRONOS_PASSWORD`
* `RUCIO_CFG_TRACER_KRONOS_PORT`
* `RUCIO_CFG_TRACER_KRONOS_PREFETCH_SIZE`
* `RUCIO_CFG_TRACER_KRONOS_QUEUE`
* `RUCIO_CFG_TRACER_KRONOS_RECONNECT_ATTEMPTS`
* `RUCIO_CFG_TRACER_KRONOS_SSL_CERT_FILE`
* `RUCIO_CFG_TRACER_KRONOS_SSL_KEY_FILE`
* `RUCIO_CFG_TRACER_KRONOS_SUBSCRIPTION_ID`
* `RUCIO_CFG_TRACER_KRONOS_USERNAME`
* `RUCIO_CFG_TRACER_KRONOS_USE_SSL`
* `RUCIO_CFG_TRANSMOGRIFIER_MAXDIDS`

## Getting Support

If you are looking for support, please contact our mailing list rucio-users@googlegroups.com
or join us on our [slack support](<https://rucio.slack.com/messages/#support>) channel.
